(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();const Vt="/assets/test-1080-CtNeF9MB.png";function Ht(n,t,e=0,i=n.length-1,s=kt){for(;i>e;){if(i-e>600){const a=i-e+1,h=t-e+1,m=Math.log(a),c=.5*Math.exp(2*m/3),f=.5*Math.sqrt(m*c*(a-c)/a)*(h-a/2<0?-1:1),M=Math.max(e,Math.floor(t-h*c/a+f)),B=Math.min(i,Math.floor(t+(a-h)*c/a+f));Ht(n,t,M,B,s)}const o=n[t];let l=e,r=i;for(J(n,e,t),s(n[i],o)>0&&J(n,e,i);l<r;){for(J(n,l,r),l++,r--;s(n[l],o)<0;)l++;for(;s(n[r],o)>0;)r--}s(n[e],o)===0?J(n,e,r):(r++,J(n,r,i)),r<=t&&(e=r+1),t<=r&&(i=r-1)}}function J(n,t,e){const i=n[t];n[t]=n[e],n[e]=i}function kt(n,t){return n<t?-1:n>t?1:0}class Bt{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!it(t,e))return i;const s=this.toBBox,o=[];for(;e;){for(let l=0;l<e.children.length;l++){const r=e.children[l],a=e.leaf?s(r):r;it(t,a)&&(e.leaf?i.push(r):at(t,a)?this._all(r,i):o.push(r))}e=o.pop()}return i}collides(t){let e=this.data;if(!it(t,e))return!1;const i=[];for(;e;){for(let s=0;s<e.children.length;s++){const o=e.children[s],l=e.leaf?this.toBBox(o):o;if(it(t,l)){if(e.leaf||at(t,l))return!0;i.push(o)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Q([]),this}remove(t,e){if(!t)return this;let i=this.data;const s=this.toBBox(t),o=[],l=[];let r,a,h;for(;i||o.length;){if(i||(i=o.pop(),a=o[o.length-1],r=l.pop(),h=!0),i.leaf){const m=Gt(t,i.children,e);if(m!==-1)return i.children.splice(m,1),o.push(i),this._condense(o),this}!h&&!i.leaf&&at(i,s)?(o.push(i),l.push(r),r=0,a=i,i=i.children[0]):a?(r++,i=a.children[r],h=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,s){const o=i-e+1;let l=this._maxEntries,r;if(o<=l)return r=Q(t.slice(e,i+1)),G(r,this.toBBox),r;s||(s=Math.ceil(Math.log(o)/Math.log(l)),l=Math.ceil(o/Math.pow(l,s-1))),r=Q([]),r.leaf=!1,r.height=s;const a=Math.ceil(o/l),h=a*Math.ceil(Math.sqrt(l));St(t,e,i,h,this.compareMinX);for(let m=e;m<=i;m+=h){const c=Math.min(m+h-1,i);St(t,m,c,a,this.compareMinY);for(let f=m;f<=c;f+=a){const M=Math.min(f+a-1,c);r.children.push(this._build(t,f,M,s-1))}}return G(r,this.toBBox),r}_chooseSubtree(t,e,i,s){for(;s.push(e),!(e.leaf||s.length-1===i);){let o=1/0,l=1/0,r;for(let a=0;a<e.children.length;a++){const h=e.children[a],m=ut(h),c=Wt(t,h)-m;c<l?(l=c,o=m<o?m:o,r=h):c===l&&m<o&&(o=m,r=h)}e=r||e.children[0]}return e}_insert(t,e,i){const s=i?t:this.toBBox(t),o=[],l=this._chooseSubtree(s,this.data,e,o);for(l.children.push(t),tt(l,s);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(s,o,e)}_split(t,e){const i=t[e],s=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,s);const l=this._chooseSplitIndex(i,o,s),r=Q(i.children.splice(l,i.children.length-l));r.height=i.height,r.leaf=i.leaf,G(i,this.toBBox),G(r,this.toBBox),e?t[e-1].children.push(r):this._splitRoot(i,r)}_splitRoot(t,e){this.data=Q([t,e]),this.data.height=t.height+1,this.data.leaf=!1,G(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let s,o=1/0,l=1/0;for(let r=e;r<=i-e;r++){const a=Z(t,0,r,this.toBBox),h=Z(t,r,i,this.toBBox),m=Jt(a,h),c=ut(a)+ut(h);m<o?(o=m,s=r,l=c<l?c:l):m===o&&c<l&&(l=c,s=r)}return s||i-e}_chooseSplitAxis(t,e,i){const s=t.leaf?this.compareMinX:jt,o=t.leaf?this.compareMinY:Qt,l=this._allDistMargin(t,e,i,s),r=this._allDistMargin(t,e,i,o);l<r&&t.children.sort(s)}_allDistMargin(t,e,i,s){t.children.sort(s);const o=this.toBBox,l=Z(t,0,e,o),r=Z(t,i-e,i,o);let a=nt(l)+nt(r);for(let h=e;h<i-e;h++){const m=t.children[h];tt(l,t.leaf?o(m):m),a+=nt(l)}for(let h=i-e-1;h>=e;h--){const m=t.children[h];tt(r,t.leaf?o(m):m),a+=nt(r)}return a}_adjustParentBBoxes(t,e,i){for(let s=i;s>=0;s--)tt(e[s],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():G(t[e],this.toBBox)}}function Gt(n,t,e){if(!e)return t.indexOf(n);for(let i=0;i<t.length;i++)if(e(n,t[i]))return i;return-1}function G(n,t){Z(n,0,n.children.length,t,n)}function Z(n,t,e,i,s){s||(s=Q(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let o=t;o<e;o++){const l=n.children[o];tt(s,n.leaf?i(l):l)}return s}function tt(n,t){return n.minX=Math.min(n.minX,t.minX),n.minY=Math.min(n.minY,t.minY),n.maxX=Math.max(n.maxX,t.maxX),n.maxY=Math.max(n.maxY,t.maxY),n}function jt(n,t){return n.minX-t.minX}function Qt(n,t){return n.minY-t.minY}function ut(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function nt(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Wt(n,t){return(Math.max(t.maxX,n.maxX)-Math.min(t.minX,n.minX))*(Math.max(t.maxY,n.maxY)-Math.min(t.minY,n.minY))}function Jt(n,t){const e=Math.max(n.minX,t.minX),i=Math.max(n.minY,t.minY),s=Math.min(n.maxX,t.maxX),o=Math.min(n.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,o-i)}function at(n,t){return n.minX<=t.minX&&n.minY<=t.minY&&t.maxX<=n.maxX&&t.maxY<=n.maxY}function it(n,t){return t.minX<=n.maxX&&t.minY<=n.maxY&&t.maxX>=n.minX&&t.maxY>=n.minY}function Q(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function St(n,t,e,i,s){const o=[t,e];for(;o.length;){if(e=o.pop(),t=o.pop(),e-t<=i)continue;const l=t+Math.ceil((e-t)/i/2)*i;Ht(n,l,t,e,s),o.push(t,l,l,e)}}class Kt{constructor(t=[],e=(i,s)=>i<s?-1:i>s?1:0){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,s=e[t];for(;t>0;){const o=t-1>>1,l=e[o];if(i(s,l)>=0)break;e[t]=l,t=o}e[t]=s}_down(t){const{data:e,compare:i}=this,s=this.length>>1,o=e[t];for(;t<s;){let l=(t<<1)+1;const r=l+1;if(r<this.length&&i(e[r],e[l])<0&&(l=r),i(e[l],o)>=0)break;e[t]=e[l],t=l}e[t]=o}}function zt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var K={exports:{}},ct,Xt;function Zt(){return Xt||(Xt=1,ct=function(t,e,i,s){var o=t[0],l=t[1],r=!1;i===void 0&&(i=0),s===void 0&&(s=e.length);for(var a=(s-i)/2,h=0,m=a-1;h<a;m=h++){var c=e[i+h*2+0],f=e[i+h*2+1],M=e[i+m*2+0],B=e[i+m*2+1],d=f>l!=B>l&&o<(M-c)*(l-f)/(B-f)+c;d&&(r=!r)}return r}),ct}var ht,Yt;function te(){return Yt||(Yt=1,ht=function(t,e,i,s){var o=t[0],l=t[1],r=!1;i===void 0&&(i=0),s===void 0&&(s=e.length);for(var a=s-i,h=0,m=a-1;h<a;m=h++){var c=e[h+i][0],f=e[h+i][1],M=e[m+i][0],B=e[m+i][1],d=f>l!=B>l&&o<(M-c)*(l-f)/(B-f)+c;d&&(r=!r)}return r}),ht}var Et;function ee(){if(Et)return K.exports;Et=1;var n=Zt(),t=te();return K.exports=function(i,s,o,l){return s.length>0&&Array.isArray(s[0])?t(i,s,o,l):n(i,s,o,l)},K.exports.nested=t,K.exports.flat=n,K.exports}var ne=ee();const ie=zt(ne),N=11102230246251565e-32,D=134217729,re=(3+8*N)*N;function ft(n,t,e,i,s){let o,l,r,a,h=t[0],m=i[0],c=0,f=0;m>h==m>-h?(o=h,h=t[++c]):(o=m,m=i[++f]);let M=0;if(c<n&&f<e)for(m>h==m>-h?(l=h+o,r=o-(l-h),h=t[++c]):(l=m+o,r=o-(l-m),m=i[++f]),o=l,r!==0&&(s[M++]=r);c<n&&f<e;)m>h==m>-h?(l=o+h,a=l-o,r=o-(l-a)+(h-a),h=t[++c]):(l=o+m,a=l-o,r=o-(l-a)+(m-a),m=i[++f]),o=l,r!==0&&(s[M++]=r);for(;c<n;)l=o+h,a=l-o,r=o-(l-a)+(h-a),h=t[++c],o=l,r!==0&&(s[M++]=r);for(;f<e;)l=o+m,a=l-o,r=o-(l-a)+(m-a),m=i[++f],o=l,r!==0&&(s[M++]=r);return(o!==0||M===0)&&(s[M++]=o),M}function oe(n,t){let e=t[0];for(let i=1;i<n;i++)e+=t[i];return e}function et(n){return new Float64Array(n)}const se=(3+16*N)*N,le=(2+12*N)*N,ue=(9+64*N)*N*N,j=et(4),_t=et(8),Pt=et(12),Ct=et(16),q=et(4);function ae(n,t,e,i,s,o,l){let r,a,h,m,c,f,M,B,d,Y,u,v,x,p,g,I,y,w;const S=n-s,X=e-s,_=t-o,E=i-o;p=S*E,f=D*S,M=f-(f-S),B=S-M,f=D*E,d=f-(f-E),Y=E-d,g=B*Y-(p-M*d-B*d-M*Y),I=_*X,f=D*_,M=f-(f-_),B=_-M,f=D*X,d=f-(f-X),Y=X-d,y=B*Y-(I-M*d-B*d-M*Y),u=g-y,c=g-u,j[0]=g-(u+c)+(c-y),v=p+u,c=v-p,x=p-(v-c)+(u-c),u=x-I,c=x-u,j[1]=x-(u+c)+(c-I),w=v+u,c=w-v,j[2]=v-(w-c)+(u-c),j[3]=w;let $=oe(4,j),P=le*l;if($>=P||-$>=P||(c=n-S,r=n-(S+c)+(c-s),c=e-X,h=e-(X+c)+(c-s),c=t-_,a=t-(_+c)+(c-o),c=i-E,m=i-(E+c)+(c-o),r===0&&a===0&&h===0&&m===0)||(P=ue*l+re*Math.abs($),$+=S*m+E*r-(_*h+X*a),$>=P||-$>=P))return $;p=r*E,f=D*r,M=f-(f-r),B=r-M,f=D*E,d=f-(f-E),Y=E-d,g=B*Y-(p-M*d-B*d-M*Y),I=a*X,f=D*a,M=f-(f-a),B=a-M,f=D*X,d=f-(f-X),Y=X-d,y=B*Y-(I-M*d-B*d-M*Y),u=g-y,c=g-u,q[0]=g-(u+c)+(c-y),v=p+u,c=v-p,x=p-(v-c)+(u-c),u=x-I,c=x-u,q[1]=x-(u+c)+(c-I),w=v+u,c=w-v,q[2]=v-(w-c)+(u-c),q[3]=w;const L=ft(4,j,4,q,_t);p=S*m,f=D*S,M=f-(f-S),B=S-M,f=D*m,d=f-(f-m),Y=m-d,g=B*Y-(p-M*d-B*d-M*Y),I=_*h,f=D*_,M=f-(f-_),B=_-M,f=D*h,d=f-(f-h),Y=h-d,y=B*Y-(I-M*d-B*d-M*Y),u=g-y,c=g-u,q[0]=g-(u+c)+(c-y),v=p+u,c=v-p,x=p-(v-c)+(u-c),u=x-I,c=x-u,q[1]=x-(u+c)+(c-I),w=v+u,c=w-v,q[2]=v-(w-c)+(u-c),q[3]=w;const F=ft(L,_t,4,q,Pt);p=r*m,f=D*r,M=f-(f-r),B=r-M,f=D*m,d=f-(f-m),Y=m-d,g=B*Y-(p-M*d-B*d-M*Y),I=a*h,f=D*a,M=f-(f-a),B=a-M,f=D*h,d=f-(f-h),Y=h-d,y=B*Y-(I-M*d-B*d-M*Y),u=g-y,c=g-u,q[0]=g-(u+c)+(c-y),v=p+u,c=v-p,x=p-(v-c)+(u-c),u=x-I,c=x-u,q[1]=x-(u+c)+(c-I),w=v+u,c=w-v,q[2]=v-(w-c)+(u-c),q[3]=w;const C=ft(F,Pt,4,q,Ct);return Ct[C-1]}function ce(n,t,e,i,s,o){const l=(t-o)*(e-s),r=(n-s)*(i-o),a=l-r,h=Math.abs(l+r);return Math.abs(a)>=se*h?a:-ae(n,t,e,i,s,o,h)}function he(n,t,e){t=Math.max(0,t===void 0?2:t),e=e||0;const i=xe(n),s=new Bt(16);s.toBBox=function(f){return{minX:f[0],minY:f[1],maxX:f[0],maxY:f[1]}},s.compareMinX=function(f,M){return f[0]-M[0]},s.compareMinY=function(f,M){return f[1]-M[1]},s.load(n);const o=[];let l;for(let f=0;f<i.length;f++){const M=i[f];s.remove(M),l=At(M,l),o.push(l)}const r=new Bt(16);for(let f=0;f<o.length;f++)r.insert(mt(o[f]));const a=t*t,h=e*e;for(;o.length;){const f=o.shift(),M=f.p,B=f.next.p,d=dt(M,B);if(d<h)continue;const Y=d/a,u=fe(s,f.prev.p,M,B,f.next.next.p,Y,r);u&&Math.min(dt(u,M),dt(u,B))<=Y&&(o.push(f),o.push(At(u,f)),s.remove(u),r.remove(f),r.insert(mt(f)),r.insert(mt(f.next)))}let m=l;const c=[];do c.push(m.p),m=m.next;while(m!==l);return c.push(m.p),c}function fe(n,t,e,i,s,o,l){const r=new Kt([],me);let a=n.data;for(;a;){for(let h=0;h<a.children.length;h++){const m=a.children[h],c=a.leaf?pt(m,e,i):de(e,i,m);c>o||r.push({node:m,dist:c})}for(;r.length&&!r.peek().node.children;){const h=r.pop(),m=h.node,c=pt(m,t,e),f=pt(m,i,s);if(h.dist<c&&h.dist<f&&Dt(e,m,l)&&Dt(i,m,l))return m}a=r.pop(),a&&(a=a.node)}return null}function me(n,t){return n.dist-t.dist}function de(n,t,e){if($t(n,e)||$t(t,e))return 0;const i=rt(n[0],n[1],t[0],t[1],e.minX,e.minY,e.maxX,e.minY);if(i===0)return 0;const s=rt(n[0],n[1],t[0],t[1],e.minX,e.minY,e.minX,e.maxY);if(s===0)return 0;const o=rt(n[0],n[1],t[0],t[1],e.maxX,e.minY,e.maxX,e.maxY);if(o===0)return 0;const l=rt(n[0],n[1],t[0],t[1],e.minX,e.maxY,e.maxX,e.maxY);return l===0?0:Math.min(i,s,o,l)}function $t(n,t){return n[0]>=t.minX&&n[0]<=t.maxX&&n[1]>=t.minY&&n[1]<=t.maxY}function Dt(n,t,e){const i=Math.min(n[0],t[0]),s=Math.min(n[1],t[1]),o=Math.max(n[0],t[0]),l=Math.max(n[1],t[1]),r=e.search({minX:i,minY:s,maxX:o,maxY:l});for(let a=0;a<r.length;a++)if(pe(r[a].p,r[a].next.p,n,t))return!1;return!0}function W(n,t,e){return ce(n[0],n[1],t[0],t[1],e[0],e[1])}function pe(n,t,e,i){return n!==i&&t!==e&&W(n,t,e)>0!=W(n,t,i)>0&&W(e,i,n)>0!=W(e,i,t)>0}function mt(n){const t=n.p,e=n.next.p;return n.minX=Math.min(t[0],e[0]),n.minY=Math.min(t[1],e[1]),n.maxX=Math.max(t[0],e[0]),n.maxY=Math.max(t[1],e[1]),n}function xe(n){let t=n[0],e=n[0],i=n[0],s=n[0];for(let r=0;r<n.length;r++){const a=n[r];a[0]<t[0]&&(t=a),a[0]>i[0]&&(i=a),a[1]<e[1]&&(e=a),a[1]>s[1]&&(s=a)}const o=[t,e,i,s],l=o.slice();for(let r=0;r<n.length;r++)ie(n[r],o)||l.push(n[r]);return ve(l)}function At(n,t){const e={p:n,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(e.next=t.next,e.prev=t,t.next.prev=e,t.next=e):(e.prev=e,e.next=e),e}function dt(n,t){const e=n[0]-t[0],i=n[1]-t[1];return e*e+i*i}function pt(n,t,e){let i=t[0],s=t[1],o=e[0]-i,l=e[1]-s;if(o!==0||l!==0){const r=((n[0]-i)*o+(n[1]-s)*l)/(o*o+l*l);r>1?(i=e[0],s=e[1]):r>0&&(i+=o*r,s+=l*r)}return o=n[0]-i,l=n[1]-s,o*o+l*l}function rt(n,t,e,i,s,o,l,r){const a=e-n,h=i-t,m=l-s,c=r-o,f=n-s,M=t-o,B=a*a+h*h,d=a*m+h*c,Y=m*m+c*c,u=a*f+h*M,v=m*f+c*M,x=B*Y-d*d;let p,g,I=x,y=x;x===0?(p=0,I=1,g=v,y=Y):(p=d*v-Y*u,g=B*v-d*u,p<0?(p=0,g=v,y=Y):p>I&&(p=I,g=v+d,y=Y)),g<0?(g=0,-u<0?p=0:-u>B?p=I:(p=-u,I=B)):g>y&&(g=y,-u+d<0?p=0:-u+d>B?p=I:(p=-u+d,I=B));const w=p===0?0:p/I,S=g===0?0:g/y,X=(1-w)*n+w*e,_=(1-w)*t+w*i,E=(1-S)*s+S*l,$=(1-S)*o+S*r,P=E-X,L=$-_;return P*P+L*L}function ge(n,t){return n[0]===t[0]?n[1]-t[1]:n[0]-t[0]}function ve(n){n.sort(ge);const t=[];for(let i=0;i<n.length;i++){for(;t.length>=2&&W(t[t.length-2],t[t.length-1],n[i])<=0;)t.pop();t.push(n[i])}const e=[];for(let i=n.length-1;i>=0;i--){for(;e.length>=2&&W(e[e.length-2],e[e.length-1],n[i])<=0;)e.pop();e.push(n[i])}return e.pop(),t.pop(),t.concat(e)}var xt={exports:{}},qt;function Me(){return qt||(qt=1,(function(n){(function(){function t(r,a){var h=r.x-a.x,m=r.y-a.y;return h*h+m*m}function e(r,a,h){var m=a.x,c=a.y,f=h.x-m,M=h.y-c;if(f!==0||M!==0){var B=((r.x-m)*f+(r.y-c)*M)/(f*f+M*M);B>1?(m=h.x,c=h.y):B>0&&(m+=f*B,c+=M*B)}return f=r.x-m,M=r.y-c,f*f+M*M}function i(r,a){for(var h=r[0],m=[h],c,f=1,M=r.length;f<M;f++)c=r[f],t(c,h)>a&&(m.push(c),h=c);return h!==c&&m.push(c),m}function s(r,a,h,m,c){for(var f=m,M,B=a+1;B<h;B++){var d=e(r[B],r[a],r[h]);d>f&&(M=B,f=d)}f>m&&(M-a>1&&s(r,a,M,m,c),c.push(r[M]),h-M>1&&s(r,M,h,m,c))}function o(r,a){var h=r.length-1,m=[r[0]];return s(r,0,h,a,m),m.push(r[h]),m}function l(r,a,h){if(r.length<=2)return r;var m=a!==void 0?a*a:1;return r=h?r:i(r,m),r=o(r,m),r}n.exports=l,n.exports.default=l})()})(xt)),xt.exports}var ye=Me();const we=zt(ye);var ot={exports:{}},Ie=ot.exports,Lt;function Be(){return Lt||(Lt=1,(function(n,t){(function(e,i){i(n)})(Ie,function(e){function i(u,v){if(!(u instanceof v))throw new TypeError("Cannot call a class as a function")}/**
 *  @preserve  JavaScript implementation of
 *  Algorithm for Automatically Fitting Digitized Curves
 *  by Philip J. Schneider
 *  "Graphics Gems", Academic Press, 1990
 *
 *  The MIT License (MIT)
 *
 *  https://github.com/soswow/fit-curves
 */function s(u,v,x){if(!Array.isArray(u))throw new TypeError("First argument should be an array");if(u.forEach(function(y){if(!Array.isArray(y)||y.some(function(w){return typeof w!="number"})||y.length!==u[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),u=u.filter(function(y,w){return w===0||!y.every(function(S,X){return S===u[w-1][X]})}),u.length<2)return[];var p=u.length,g=B(u[1],u[0]),I=B(u[p-2],u[p-1]);return o(u,g,I,v,x)}function o(u,v,x,p,g){var I=20,y,w,S,X,_,E,$,P,L,F,C,O,U;if(u.length===2)return O=d.vectorLen(d.subtract(u[0],u[1]))/3,y=[u[0],d.addArrays(u[0],d.mulItems(v,O)),d.addArrays(u[1],d.mulItems(x,O)),u[1]],[y];w=m(u);var b=l(u,w,w,v,x,g);if(y=b[0],X=b[1],E=b[2],X===0||X<p)return[y];if(X<p*p)for(S=w,_=X,$=E,U=0;U<I;U++){S=a(y,u,S);var T=l(u,w,S,v,x,g);if(y=T[0],X=T[1],E=T[2],X<p)return[y];if(E===$){var H=X/_;if(H>.9999&&H<1.0001)break}_=X,$=E}if(C=[],P=d.subtract(u[E-1],u[E+1]),P.every(function(Ut){return Ut===0})){P=d.subtract(u[E-1],u[E]);var z=[-P[1],P[0]];P[0]=z[0],P[1]=z[1]}return L=d.normalize(P),F=d.mulItems(L,-1),C=C.concat(o(u.slice(0,E+1),v,L,p,g)),C=C.concat(o(u.slice(E),F,x,p,g)),C}function l(u,v,x,p,g,I){var y,w,S;y=r(u,x,p,g);var X=c(u,y,v);return w=X[0],S=X[1],I&&I({bez:y,points:u,params:v,maxErr:w,maxPoint:S}),[y,w,S]}function r(u,v,x,p){var g,I,y,w,S,X,_,E,$,P,L,F,C,O,U,b,T,H=u[0],z=u[u.length-1];for(g=[H,null,null,z],I=d.zeros_Xx2x2(v.length),C=0,O=v.length;C<O;C++)b=v[C],T=1-b,y=I[C],y[0]=d.mulItems(x,3*b*(T*T)),y[1]=d.mulItems(p,3*T*(b*b));for(w=[[0,0],[0,0]],S=[0,0],C=0,O=u.length;C<O;C++)b=v[C],y=I[C],w[0][0]+=d.dot(y[0],y[0]),w[0][1]+=d.dot(y[0],y[1]),w[1][0]+=d.dot(y[0],y[1]),w[1][1]+=d.dot(y[1],y[1]),U=d.subtract(u[C],Y.q([H,H,z,z],b)),S[0]+=d.dot(y[0],U),S[1]+=d.dot(y[1],U);return X=w[0][0]*w[1][1]-w[1][0]*w[0][1],_=w[0][0]*S[1]-w[1][0]*S[0],E=S[0]*w[1][1]-S[1]*w[0][1],$=X===0?0:E/X,P=X===0?0:_/X,F=d.vectorLen(d.subtract(H,z)),L=1e-6*F,$<L||P<L?(g[1]=d.addArrays(H,d.mulItems(x,F/3)),g[2]=d.addArrays(z,d.mulItems(p,F/3))):(g[1]=d.addArrays(H,d.mulItems(x,$)),g[2]=d.addArrays(z,d.mulItems(p,P))),g}function a(u,v,x){return x.map(function(p,g){return h(u,v[g],p)})}function h(u,v,x){var p=d.subtract(Y.q(u,x),v),g=Y.qprime(u,x),I=d.mulMatrix(p,g),y=d.sum(d.squareItems(g))+2*d.mulMatrix(p,Y.qprimeprime(u,x));return y===0?x:x-I/y}function m(u){var v=[],x,p,g;return u.forEach(function(I,y){x=y?p+d.vectorLen(d.subtract(I,g)):0,v.push(x),p=x,g=I}),v=v.map(function(I){return I/p}),v}function c(u,v,x){var p,g,I,y,w,S,X,_;g=0,I=Math.floor(u.length/2);var E=f(v,10);for(w=0,S=u.length;w<S;w++)X=u[w],_=M(v,x[w],E,10),y=d.subtract(Y.q(v,_),X),p=y[0]*y[0]+y[1]*y[1],p>g&&(g=p,I=w);return[g,I]}var f=function(v,x){for(var p,g=[0],I=v[0],y=0,w=1;w<=x;w++)p=Y.q(v,w/x),y+=d.vectorLen(d.subtract(p,I)),g.push(y),I=p;return g=g.map(function(S){return S/y}),g};function M(u,v,x,p){if(v<0)return 0;if(v>1)return 1;for(var g,I,y,w,S,X=1;X<=p;X++)if(v<=x[X]){w=(X-1)/p,y=X/p,I=x[X-1],g=x[X],S=(v-I)/(g-I)*(y-w)+w;break}return S}function B(u,v){return d.normalize(d.subtract(u,v))}var d=(function(){function u(){i(this,u)}return u.zeros_Xx2x2=function(x){for(var p=[];x--;)p.push([0,0]);return p},u.mulItems=function(x,p){return x.map(function(g){return g*p})},u.mulMatrix=function(x,p){return x.reduce(function(g,I,y){return g+I*p[y]},0)},u.subtract=function(x,p){return x.map(function(g,I){return g-p[I]})},u.addArrays=function(x,p){return x.map(function(g,I){return g+p[I]})},u.addItems=function(x,p){return x.map(function(g){return g+p})},u.sum=function(x){return x.reduce(function(p,g){return p+g})},u.dot=function(x,p){return u.mulMatrix(x,p)},u.vectorLen=function(x){return Math.hypot.apply(Math,x)},u.divItems=function(x,p){return x.map(function(g){return g/p})},u.squareItems=function(x){return x.map(function(p){return p*p})},u.normalize=function(x){return this.divItems(x,this.vectorLen(x))},u})(),Y=(function(){function u(){i(this,u)}return u.q=function(x,p){var g=1-p,I=d.mulItems(x[0],g*g*g),y=d.mulItems(x[1],3*g*g*p),w=d.mulItems(x[2],3*g*p*p),S=d.mulItems(x[3],p*p*p);return d.addArrays(d.addArrays(I,y),d.addArrays(w,S))},u.qprime=function(x,p){var g=1-p,I=d.mulItems(d.subtract(x[1],x[0]),3*g*g),y=d.mulItems(d.subtract(x[2],x[1]),6*g*p),w=d.mulItems(d.subtract(x[3],x[2]),3*p*p);return d.addArrays(d.addArrays(I,y),w)},u.qprimeprime=function(x,p){return d.addArrays(d.mulItems(d.addArrays(d.subtract(x[2],d.mulItems(x[1],2)),x[0]),6*(1-p)),d.mulItems(d.addArrays(d.subtract(x[3],d.mulItems(x[2],2)),x[1]),6*p))},u})();e.exports=s,e.exports.fitCubic=o,e.exports.createTangent=B})})(ot)),ot.exports}var bt=Be();function A(n,t=3){let e=10**t;return(Math.round(n*e)/e).toString()}var Se=class Nt{static concavity=1;color;hullPoints;cubics;isValid;constructor(t,e,i,s){this.color=t;let o=e.map(l=>[l.x,l.y]);if(this.hullPoints=this.reducePoints(he(o,Nt.concavity,1).map(([l,r])=>({x:l,y:r})),i),this.isValid=this.hullPoints.length>=3,this.isValid){let l=({x:h,y:m})=>[h,m],r=([h,m])=>({x:h,y:m}),a=bt.createTangent(l(this.hullPoints[1]),l(this.hullPoints[this.hullPoints.length-2]));this.cubics=bt.fitCubic(this.hullPoints.map(h=>l(h)),a,a.map(h=>-h),s).map(([h,m,c,f])=>[r(h),r(m),r(c),r(f)])}}reducePoints(t,e){return we(t,e,!0)}getPathData(){if(!this.cubics)return"";let t=[],e=this.cubics[0];t.push(`M ${A(e[0].x)} ${A(e[0].y)}`);for(let i of this.cubics)t.push(`C ${A(i[1].x)} ${A(i[1].y)}, ${A(i[2].x)} ${A(i[2].y)}, ${A(i[3].x)} ${A(i[3].y)}`);return t.push("Z"),t.join(" ")}getPathElem(){return this.isValid?`<path fill="rgb(${this.color.r},${this.color.g},${this.color.b})" d="${this.getPathData()}" />
`:""}},Xe=class{width;height;curveFittingTolerance;pathSimpMinDist;pixelGridStepSize;validHulls;minHullDistance;debugPointRadius;constructor(n,t,e){if(!n)throw new Error("imageData is required");if(!t?.length)throw new Error("palette must contain at least one color");let{pathSimplificationTolerance:i,curveFittingTolerance:s,minHullDistance:o=3,pixelGridStepSize:l=1,debugPointRadius:r}=e;this.width=n.width,this.height=n.height,this.curveFittingTolerance=s*(Math.max(this.width,this.height)/1e3),this.pathSimpMinDist=Math.max(0,i),this.pixelGridStepSize=Math.max(1,Math.round(l)),this.minHullDistance=o,this.debugPointRadius=r,this.validHulls=this.createHullsFromPalette(n,t)}getHullsByColor(n){return this.validHulls.find(t=>this.colorsMatch(t.color,n))}getSVGString(){let n=[`<svg width="${this.width}" height="${this.height}" `,`version="1.1" xmlns="http://www.w3.org/2000/svg">
`];for(let t of this.validHulls)if(n.push(t.getPathElem()),this.debugPointRadius!==void 0){for(let e of t.hullPoints)n.push(`<circle cx="${A(e.x)}" cy="${A(e.y)}" r="${this.debugPointRadius}" fill="none" stroke="#000" strokeWeight="${this.debugPointRadius/5}" />
`);if(t.cubics!==void 0)for(let e of t.cubics)n.push(`<circle cx="${A(e[0].x)}" cy="${A(e[0].y)}" r="${this.debugPointRadius}" fill="#000" stroke="none" />
<circle cx="${A(e[1].x)}" cy="${A(e[1].y)}" r="${this.debugPointRadius/2}" fill="#000" stroke="none" />
<circle cx="${A(e[2].x)}" cy="${A(e[2].y)}" r="${this.debugPointRadius/2}" fill="#000" stroke="none" />
`)}return n.push("</svg>"),n.join("")}createHullsFromPalette(n,t){return t.map(e=>this.createHullsForColor(n,e)).flat().filter(e=>e.isValid)}createHullsForColor(n,t){let e=this.createMaskPointCloud(n,t);return this.separatePointClouds(e).map(i=>new Se(t,i,this.pathSimpMinDist,this.curveFittingTolerance))}separatePointClouds(n){let t=[];if(n.length===0)return t;let e=Math.max(0,this.minHullDistance);if(this.pixelGridStepSize>e)throw new Error("Pixel grid step needs to be smaller than the minimum hull distance.");let i=e*e,s=e,o=new Map;for(let r=0;r<n.length;r++){let a=n[r],h=Math.floor(a.x/s),m=Math.floor(a.y/s),c=`${h},${m}`;(o.get(c)??o.set(c,[]).get(c)).push(r)}let l=new Uint8Array(n.length);for(let r=0;r<n.length;r++){if(l[r])continue;let a=[],h=[],m=0;for(h.push(r),l[r]=1;m<h.length;){let c=h[m++],f=n[c];a.push(f);let M=Math.floor(f.x/s),B=Math.floor(f.y/s);for(let d=M-1;d<=M+1;d++)for(let Y=B-1;Y<=B+1;Y++){let u=`${d},${Y}`,v=o.get(u);if(v)for(let x of v){if(l[x])continue;let p=n[x],g=p.x-f.x,I=p.y-f.y;Math.abs(g)+Math.abs(I)>e*2||g*g+I*I<=i&&(l[x]=1,h.push(x))}}}a.length&&t.push(a)}return t}createMaskPointCloud(n,t){let{data:e,width:i,height:s}=n,o=[],l=this.pixelGridStepSize;for(let r=0;r<s;r+=l)for(let a=0;a<i;a+=l){let h=(r*i+a)*4;this.pixelMatches(e,h,t)&&o.push({x:a,y:r})}return o}pixelMatches(n,t,e){return n[t+3]!==0&&n[t]===e.r&&n[t+1]===e.g&&n[t+2]===e.b}colorsMatch(n,t){return n.r===t.r&&n.g===t.g&&n.b===t.b}};const R=document.getElementById("source-image"),Ot=document.getElementById("image-upload"),V=document.getElementById("work-canvas"),gt=V.getContext("2d"),Ye=document.getElementById("trace-button"),wt=document.getElementById("download-button"),st=document.getElementById("status"),Rt=document.getElementById("palette-info"),vt=document.getElementById("svg-output"),k={colorStep:document.getElementById("color-step"),pathSimplification:document.getElementById("path-simplification"),curveFitting:document.getElementById("curve-fitting"),minHull:document.getElementById("min-hull"),pixelStep:document.getElementById("pixel-step")},Ee={colorStep:document.getElementById("color-step-value"),pathSimplification:document.getElementById("path-simplification-value"),curveFitting:document.getElementById("curve-fitting-value"),minHull:document.getElementById("min-hull-value"),pixelStep:document.getElementById("pixel-step-value")};let lt=null,Mt=null,It=null;function _e(n,t){switch(n){case"colorStep":case"pixelStep":case"minHull":return Math.round(t);default:return Number.parseFloat(t).toFixed(1)}}function Ft(){for(const[n,t]of Object.entries(k))Ee[n].textContent=_e(n,t.value)}function Pe(n,t){const e=new Map,i=Math.max(1,Number(t)||1),{data:s}=n;for(let o=0;o<s.length;o+=4){if(s[o+3]<32)continue;const r=Math.min(255,Math.round(s[o]/i)*i),a=Math.min(255,Math.round(s[o+1]/i)*i),h=Math.min(255,Math.round(s[o+2]/i)*i),m=`${r},${a},${h}`;e.has(m)||e.set(m,{r,g:a,b:h})}return Array.from(e.values())}function Ce(){if(!R.complete||R.naturalWidth===0)throw new Error("Image is still loading");return V.width=R.naturalWidth,V.height=R.naturalHeight,gt.clearRect(0,0,V.width,V.height),gt.drawImage(R,0,0),gt.getImageData(0,0,V.width,V.height)}function yt(){clearTimeout(It),It=setTimeout(()=>{Tt()},120)}function Tt(){clearTimeout(It),st.textContent="Tracing…",Rt.textContent="",vt.innerHTML="",wt.disabled=!0;try{const n=Ce(),t=Number(k.colorStep.value),e=Pe(n,t);if(!e.length)throw new Error("No opaque pixels were found in the image.");const i={pathSimplificationTolerance:Number(k.pathSimplification.value),curveFittingTolerance:Number(k.curveFitting.value),minHullDistance:Number(k.minHull.value),pixelGridStepSize:Number(k.pixelStep.value)};if(i.pixelGridStepSize>i.minHullDistance)throw new Error("Pixel grid step size must not exceed the minimum hull distance.");const s=new Xe(n,e,i),o=s.getSVGString();vt.innerHTML=o;const l=vt.querySelector("svg");l&&l.setAttribute("viewBox",`0 0 ${n.width} ${n.height}`),Rt.textContent=`Palette size: ${e.length} colours`,st.textContent=`Tracing complete (${n.width}×${n.height}).`,wt.disabled=!1,lt=s}catch(n){console.error(n),st.textContent=n.message??String(n),lt=null}}function $e(n){const t=n.target.files?.[0];if(!t)return;Mt&&URL.revokeObjectURL(Mt);const e=URL.createObjectURL(t);Mt=e,R.src=e,Ot.value=""}function De(){Ft(),Ye.addEventListener("click",()=>Tt()),wt.addEventListener("click",()=>{lt&&lt.downloadSVG("trace-result.svg")});for(const n of Object.values(k))n.addEventListener("input",()=>{Ft(),yt()});Ot.addEventListener("change",$e),R.addEventListener("load",()=>{yt()}),R.addEventListener("error",()=>{st.textContent="Could not load the image."}),R.src=Vt,R.complete&&yt()}De();
